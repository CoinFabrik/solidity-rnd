{
    "description": {
        "project_name": "Warped Games",
        "compiler_versions": [
            "0.8.11"
        ]
    },
    "findings": [
        {
            "title": "Denial of Service",
            "reported_impact": "Critical",
            "reported_likelihood": "High",
            "cwe_classification": 400,
            "vulnerability_class": "Denial Service",
            "vulnerability_subclass": "Resource Exhaustion",
            "vulnerable_functions": [
                "WarpedTaxHandler.sol::removeNFTs()"
            ],
            "lines": "154-165",
            "description": "Deletes an element from an array, but forgets to delete the place it occupies.",
            "possible_found_in": [
                {
                    "element": {
                        "type": "function",
                        "name": "removeNFTs",
                        "source_mapping": {
                            "start": 4932,
                            "length": 377,
                            "filename_relative": "contracts/WarpedTaxHandler.sol",
                            "filename_absolute": "/home/tiki/trabajo/goose/WarpedGames00/vulnerable/contracts-warped-token/contracts/WarpedTaxHandler.sol",
                            "filename_short": "contracts/WarpedTaxHandler.sol",
                            "is_dependency": false,
                            "lines": [
                                154,
                                155,
                                156,
                                157,
                                158,
                                159,
                                160,
                                161,
                                162,
                                163,
                                164,
                                165
                            ],
                            "starting_column": 2,
                            "ending_column": 3
                        },
                        "type_specific_fields": {
                            "parent": {
                                "type": "contract",
                                "name": "WarpedTaxHandler",
                                "source_mapping": {
                                    "start": 783,
                                    "length": 6222,
                                    "filename_relative": "contracts/WarpedTaxHandler.sol",
                                    "filename_absolute": "/home/tiki/trabajo/goose/WarpedGames00/vulnerable/contracts-warped-token/contracts/WarpedTaxHandler.sol",
                                    "filename_short": "contracts/WarpedTaxHandler.sol",
                                    "is_dependency": false,
                                    "lines": [
                                        21,
                                        22,
                                        23,
                                        24,
                                        25,
                                        26,
                                        27,
                                        28,
                                        29,
                                        30,
                                        31,
                                        32,
                                        33,
                                        34,
                                        35,
                                        36,
                                        37,
                                        38,
                                        39,
                                        40,
                                        41,
                                        42,
                                        43,
                                        44,
                                        45,
                                        46,
                                        47,
                                        48,
                                        49,
                                        50,
                                        51,
                                        52,
                                        53,
                                        54,
                                        55,
                                        56,
                                        57,
                                        58,
                                        59,
                                        60,
                                        61,
                                        62,
                                        63,
                                        64,
                                        65,
                                        66,
                                        67,
                                        68,
                                        69,
                                        70,
                                        71,
                                        72,
                                        73,
                                        74,
                                        75,
                                        76,
                                        77,
                                        78,
                                        79,
                                        80,
                                        81,
                                        82,
                                        83,
                                        84,
                                        85,
                                        86,
                                        87,
                                        88,
                                        89,
                                        90,
                                        91,
                                        92,
                                        93,
                                        94,
                                        95,
                                        96,
                                        97,
                                        98,
                                        99,
                                        100,
                                        101,
                                        102,
                                        103,
                                        104,
                                        105,
                                        106,
                                        107,
                                        108,
                                        109,
                                        110,
                                        111,
                                        112,
                                        113,
                                        114,
                                        115,
                                        116,
                                        117,
                                        118,
                                        119,
                                        120,
                                        121,
                                        122,
                                        123,
                                        124,
                                        125,
                                        126,
                                        127,
                                        128,
                                        129,
                                        130,
                                        131,
                                        132,
                                        133,
                                        134,
                                        135,
                                        136,
                                        137,
                                        138,
                                        139,
                                        140,
                                        141,
                                        142,
                                        143,
                                        144,
                                        145,
                                        146,
                                        147,
                                        148,
                                        149,
                                        150,
                                        151,
                                        152,
                                        153,
                                        154,
                                        155,
                                        156,
                                        157,
                                        158,
                                        159,
                                        160,
                                        161,
                                        162,
                                        163,
                                        164,
                                        165,
                                        166,
                                        167,
                                        168,
                                        169,
                                        170,
                                        171,
                                        172,
                                        173,
                                        174,
                                        175,
                                        176,
                                        177,
                                        178,
                                        179,
                                        180,
                                        181,
                                        182,
                                        183,
                                        184,
                                        185,
                                        186,
                                        187,
                                        188,
                                        189,
                                        190,
                                        191,
                                        192,
                                        193,
                                        194,
                                        195,
                                        196,
                                        197,
                                        198,
                                        199,
                                        200,
                                        201,
                                        202,
                                        203,
                                        204,
                                        205,
                                        206,
                                        207,
                                        208,
                                        209,
                                        210,
                                        211,
                                        212,
                                        213,
                                        214,
                                        215,
                                        216,
                                        217,
                                        218,
                                        219,
                                        220,
                                        221,
                                        222,
                                        223,
                                        224
                                    ],
                                    "starting_column": 1,
                                    "ending_column": 2
                                }
                            },
                            "signature": "removeNFTs(address[])"
                        }
                    },
                    "detector": {
                        "description": "WarpedTaxHandler.removeNFTs(address[]) (contracts/WarpedTaxHandler.sol#154-165) has costly operations inside a loop:\n\t- delete nftContracts[j] (contracts/WarpedTaxHandler.sol#159)\n",
                        "markdown": "[WarpedTaxHandler.removeNFTs(address[])](contracts/WarpedTaxHandler.sol#L154-L165) has costly operations inside a loop:\n\t- [delete nftContracts[j]](contracts/WarpedTaxHandler.sol#L159)\n",
                        "first_markdown_element": "contracts/WarpedTaxHandler.sol#L154-L165",
                        "id": "2e88079a680069f9e7e568a683cae19fd84bbe11d94b3254dcee0d1ada4c8681",
                        "check": "costly-loop",
                        "impact": "Informational",
                        "confidence": "Medium"
                    }
                }
            ]
        },
        {
            "title": "Front Running",
            "reported_impact": "High",
            "reported_likelihood": "Medium",
            "cwe_classification": 0,
            "vulnerability_class": "MEV",
            "vulnerability_subclass": "Front Running",
            "vulnerable_functions": [
                "WarpedTreasuryHandler.sol::addLiquidity()",
                "WarpedTreasuryHandler.sol::addLiquidity()",
                "WarpedTreasuryHandler.sol::_swapTokensForEth()"
            ],
            "lines": "",
            "description": "Amount values are set to 0 when interacting with Uniswap. This allows attackers to conduct frontal attacks and operations can generate unexpected amounts of tokens."
        },
        {
            "title": "Denial Of Service",
            "reported_impact": "High",
            "reported_likelihood": "Medium",
            "cwe_classification": 400,
            "vulnerability_class": "Denial Service",
            "vulnerability_subclass": "Resource Exhaustion",
            "vulnerable_functions": [
                "WarpedTokenManager.sol::_getTaxBasisPoints()"
            ],
            "lines": "",
            "description": "tour all NFTs and tax rates. In case the arrays are large enough to exceed the gas limit of the block, the execution may fail."
        },
        {
            "title": "Data Consistency",
            "reported_impact": "Medium",
            "reported_likelihood": "Medium",
            "cwe_classification": 672,
            "vulnerability_class": "Data Consistency",
            "vulnerability_subclass": "State Management",
            "vulnerable_functions": [
                "WarpedPoolManager.sol::_exchangePools"
            ],
            "lines": "",
            "description": "The primary pool address may be removed from the _exchangePools and be not updated in the primaryPool variable. This will result in inconsistent contract state"
        },
        {
            "title": "Data Consistency",
            "reported_impact": "Medium",
            "reported_likelihood": "Medium",
            "cwe_classification": 703,
            "vulnerability_class": "Validation",
            "vulnerability_subclass": "Uniqueness Check Missing",
            "vulnerable_functions": [
                "WarpedTaxHandler.sol::addNFTs()"
            ],
            "lines": "142-148",
            "description": "The NFTs are not being checked for the uniqueness when they are added. This may result in duplicates and inconsistent contract state."
        },
        {
            "title": "Requirement Violation- Data Consistency",
            "reported_impact": "Medium",
            "reported_likelihood": "Medium",
            "cwe_classification": 670,
            "vulnerability_class": "Data Consistency",
            "vulnerability_subclass": "Requirement Violation",
            "vulnerable_functions": [
                "WarpedTaxHandler.sol::setTaxRates()"
            ],
            "lines": "119-134",
            "description": "In the function setTaxRates(), the requirement says :- values of `thresholds` must be placed in ascending order. There is no check done to verify this requirement.",
            "possible_found_in": [
                {
                    "element": {
                        "type": "function",
                        "name": "setTaxRates",
                        "source_mapping": {
                            "start": 3794,
                            "length": 559,
                            "filename_relative": "contracts/WarpedTaxHandler.sol",
                            "filename_absolute": "/home/tiki/trabajo/goose/WarpedGames00/vulnerable/contracts-warped-token/contracts/WarpedTaxHandler.sol",
                            "filename_short": "contracts/WarpedTaxHandler.sol",
                            "is_dependency": false,
                            "lines": [
                                119,
                                120,
                                121,
                                122,
                                123,
                                124,
                                125,
                                126,
                                127,
                                128,
                                129,
                                130,
                                131,
                                132,
                                133,
                                134
                            ],
                            "starting_column": 2,
                            "ending_column": 3
                        },
                        "type_specific_fields": {
                            "parent": {
                                "type": "contract",
                                "name": "WarpedTaxHandler",
                                "source_mapping": {
                                    "start": 783,
                                    "length": 6222,
                                    "filename_relative": "contracts/WarpedTaxHandler.sol",
                                    "filename_absolute": "/home/tiki/trabajo/goose/WarpedGames00/vulnerable/contracts-warped-token/contracts/WarpedTaxHandler.sol",
                                    "filename_short": "contracts/WarpedTaxHandler.sol",
                                    "is_dependency": false,
                                    "lines": [
                                        21,
                                        22,
                                        23,
                                        24,
                                        25,
                                        26,
                                        27,
                                        28,
                                        29,
                                        30,
                                        31,
                                        32,
                                        33,
                                        34,
                                        35,
                                        36,
                                        37,
                                        38,
                                        39,
                                        40,
                                        41,
                                        42,
                                        43,
                                        44,
                                        45,
                                        46,
                                        47,
                                        48,
                                        49,
                                        50,
                                        51,
                                        52,
                                        53,
                                        54,
                                        55,
                                        56,
                                        57,
                                        58,
                                        59,
                                        60,
                                        61,
                                        62,
                                        63,
                                        64,
                                        65,
                                        66,
                                        67,
                                        68,
                                        69,
                                        70,
                                        71,
                                        72,
                                        73,
                                        74,
                                        75,
                                        76,
                                        77,
                                        78,
                                        79,
                                        80,
                                        81,
                                        82,
                                        83,
                                        84,
                                        85,
                                        86,
                                        87,
                                        88,
                                        89,
                                        90,
                                        91,
                                        92,
                                        93,
                                        94,
                                        95,
                                        96,
                                        97,
                                        98,
                                        99,
                                        100,
                                        101,
                                        102,
                                        103,
                                        104,
                                        105,
                                        106,
                                        107,
                                        108,
                                        109,
                                        110,
                                        111,
                                        112,
                                        113,
                                        114,
                                        115,
                                        116,
                                        117,
                                        118,
                                        119,
                                        120,
                                        121,
                                        122,
                                        123,
                                        124,
                                        125,
                                        126,
                                        127,
                                        128,
                                        129,
                                        130,
                                        131,
                                        132,
                                        133,
                                        134,
                                        135,
                                        136,
                                        137,
                                        138,
                                        139,
                                        140,
                                        141,
                                        142,
                                        143,
                                        144,
                                        145,
                                        146,
                                        147,
                                        148,
                                        149,
                                        150,
                                        151,
                                        152,
                                        153,
                                        154,
                                        155,
                                        156,
                                        157,
                                        158,
                                        159,
                                        160,
                                        161,
                                        162,
                                        163,
                                        164,
                                        165,
                                        166,
                                        167,
                                        168,
                                        169,
                                        170,
                                        171,
                                        172,
                                        173,
                                        174,
                                        175,
                                        176,
                                        177,
                                        178,
                                        179,
                                        180,
                                        181,
                                        182,
                                        183,
                                        184,
                                        185,
                                        186,
                                        187,
                                        188,
                                        189,
                                        190,
                                        191,
                                        192,
                                        193,
                                        194,
                                        195,
                                        196,
                                        197,
                                        198,
                                        199,
                                        200,
                                        201,
                                        202,
                                        203,
                                        204,
                                        205,
                                        206,
                                        207,
                                        208,
                                        209,
                                        210,
                                        211,
                                        212,
                                        213,
                                        214,
                                        215,
                                        216,
                                        217,
                                        218,
                                        219,
                                        220,
                                        221,
                                        222,
                                        223,
                                        224
                                    ],
                                    "starting_column": 1,
                                    "ending_column": 2
                                }
                            },
                            "signature": "setTaxRates(uint256[],uint256[],uint256)"
                        }
                    },
                    "detector": {
                        "description": "WarpedTaxHandler.setTaxRates(uint256[],uint256[],uint256) (contracts/WarpedTaxHandler.sol#119-134) should emit an event for: \n\t- basisTaxRate = _basisTaxRate (contracts/WarpedTaxHandler.sol#133) \n",
                        "markdown": "[WarpedTaxHandler.setTaxRates(uint256[],uint256[],uint256)](contracts/WarpedTaxHandler.sol#L119-L134) should emit an event for: \n\t- [basisTaxRate = _basisTaxRate](contracts/WarpedTaxHandler.sol#L133) \n",
                        "first_markdown_element": "contracts/WarpedTaxHandler.sol#L119-L134",
                        "id": "2a19e609790f65aa0728d133b51e79edd7e67778c1cba8cff6a9d2a365ab5c10",
                        "check": "events-maths",
                        "impact": "Low",
                        "confidence": "Medium"
                    }
                },
                {
                    "element": {
                        "type": "variable",
                        "name": "_basisTaxRate",
                        "source_mapping": {
                            "start": 3875,
                            "length": 21,
                            "filename_relative": "contracts/WarpedTaxHandler.sol",
                            "filename_absolute": "/home/tiki/trabajo/goose/WarpedGames00/vulnerable/contracts-warped-token/contracts/WarpedTaxHandler.sol",
                            "filename_short": "contracts/WarpedTaxHandler.sol",
                            "is_dependency": false,
                            "lines": [
                                122
                            ],
                            "starting_column": 3,
                            "ending_column": 24
                        },
                        "type_specific_fields": {
                            "parent": {
                                "type": "function",
                                "name": "setTaxRates",
                                "source_mapping": {
                                    "start": 3794,
                                    "length": 559,
                                    "filename_relative": "contracts/WarpedTaxHandler.sol",
                                    "filename_absolute": "/home/tiki/trabajo/goose/WarpedGames00/vulnerable/contracts-warped-token/contracts/WarpedTaxHandler.sol",
                                    "filename_short": "contracts/WarpedTaxHandler.sol",
                                    "is_dependency": false,
                                    "lines": [
                                        119,
                                        120,
                                        121,
                                        122,
                                        123,
                                        124,
                                        125,
                                        126,
                                        127,
                                        128,
                                        129,
                                        130,
                                        131,
                                        132,
                                        133,
                                        134
                                    ],
                                    "starting_column": 2,
                                    "ending_column": 3
                                },
                                "type_specific_fields": {
                                    "parent": {
                                        "type": "contract",
                                        "name": "WarpedTaxHandler",
                                        "source_mapping": {
                                            "start": 783,
                                            "length": 6222,
                                            "filename_relative": "contracts/WarpedTaxHandler.sol",
                                            "filename_absolute": "/home/tiki/trabajo/goose/WarpedGames00/vulnerable/contracts-warped-token/contracts/WarpedTaxHandler.sol",
                                            "filename_short": "contracts/WarpedTaxHandler.sol",
                                            "is_dependency": false,
                                            "lines": [
                                                21,
                                                22,
                                                23,
                                                24,
                                                25,
                                                26,
                                                27,
                                                28,
                                                29,
                                                30,
                                                31,
                                                32,
                                                33,
                                                34,
                                                35,
                                                36,
                                                37,
                                                38,
                                                39,
                                                40,
                                                41,
                                                42,
                                                43,
                                                44,
                                                45,
                                                46,
                                                47,
                                                48,
                                                49,
                                                50,
                                                51,
                                                52,
                                                53,
                                                54,
                                                55,
                                                56,
                                                57,
                                                58,
                                                59,
                                                60,
                                                61,
                                                62,
                                                63,
                                                64,
                                                65,
                                                66,
                                                67,
                                                68,
                                                69,
                                                70,
                                                71,
                                                72,
                                                73,
                                                74,
                                                75,
                                                76,
                                                77,
                                                78,
                                                79,
                                                80,
                                                81,
                                                82,
                                                83,
                                                84,
                                                85,
                                                86,
                                                87,
                                                88,
                                                89,
                                                90,
                                                91,
                                                92,
                                                93,
                                                94,
                                                95,
                                                96,
                                                97,
                                                98,
                                                99,
                                                100,
                                                101,
                                                102,
                                                103,
                                                104,
                                                105,
                                                106,
                                                107,
                                                108,
                                                109,
                                                110,
                                                111,
                                                112,
                                                113,
                                                114,
                                                115,
                                                116,
                                                117,
                                                118,
                                                119,
                                                120,
                                                121,
                                                122,
                                                123,
                                                124,
                                                125,
                                                126,
                                                127,
                                                128,
                                                129,
                                                130,
                                                131,
                                                132,
                                                133,
                                                134,
                                                135,
                                                136,
                                                137,
                                                138,
                                                139,
                                                140,
                                                141,
                                                142,
                                                143,
                                                144,
                                                145,
                                                146,
                                                147,
                                                148,
                                                149,
                                                150,
                                                151,
                                                152,
                                                153,
                                                154,
                                                155,
                                                156,
                                                157,
                                                158,
                                                159,
                                                160,
                                                161,
                                                162,
                                                163,
                                                164,
                                                165,
                                                166,
                                                167,
                                                168,
                                                169,
                                                170,
                                                171,
                                                172,
                                                173,
                                                174,
                                                175,
                                                176,
                                                177,
                                                178,
                                                179,
                                                180,
                                                181,
                                                182,
                                                183,
                                                184,
                                                185,
                                                186,
                                                187,
                                                188,
                                                189,
                                                190,
                                                191,
                                                192,
                                                193,
                                                194,
                                                195,
                                                196,
                                                197,
                                                198,
                                                199,
                                                200,
                                                201,
                                                202,
                                                203,
                                                204,
                                                205,
                                                206,
                                                207,
                                                208,
                                                209,
                                                210,
                                                211,
                                                212,
                                                213,
                                                214,
                                                215,
                                                216,
                                                217,
                                                218,
                                                219,
                                                220,
                                                221,
                                                222,
                                                223,
                                                224
                                            ],
                                            "starting_column": 1,
                                            "ending_column": 2
                                        }
                                    },
                                    "signature": "setTaxRates(uint256[],uint256[],uint256)"
                                }
                            }
                        },
                        "additional_fields": {
                            "target": "parameter",
                            "convention": "mixedCase"
                        }
                    },
                    "detector": {
                        "description": "Parameter WarpedTaxHandler.setTaxRates(uint256[],uint256[],uint256)._basisTaxRate (contracts/WarpedTaxHandler.sol#122) is not in mixedCase\n",
                        "markdown": "Parameter [WarpedTaxHandler.setTaxRates(uint256[],uint256[],uint256)._basisTaxRate](contracts/WarpedTaxHandler.sol#L122) is not in mixedCase\n",
                        "first_markdown_element": "contracts/WarpedTaxHandler.sol#L122",
                        "id": "b6fc53123217608d0128463a9931014c0f6cec2f7fec39c39ce08286e2692195",
                        "check": "naming-convention",
                        "impact": "Informational",
                        "confidence": "High"
                    }
                }
            ]
        },
        {
            "title": "Missing Event",
            "reported_impact": "Medium",
            "reported_likelihood": "Medium",
            "cwe_classification": 778,
            "vulnerability_class": "Best practices",
            "vulnerability_subclass": "Missing Event",
            "vulnerable_functions": [
                "WarpedTaxHandler.sol::"
            ],
            "lines": "",
            "description": "Events for critical state changes should be emitted for tracking things off-chain."
        },
        {
            "title": "Unchecked Transfer",
            "reported_impact": "Medium",
            "reported_likelihood": "Medium",
            "cwe_classification": 703,
            "vulnerability_class": "Validation",
            "vulnerability_subclass": "Unchecked Return Value",
            "vulnerable_functions": [
                "WarpedTreasuryHandler.sol::withdraw()"
            ],
            "lines": "",
            "description": "The function withdraw() does not use SafeERC20 library for checking the result of ERC20 token transfer."
        }
    ]
}