{
    "description": {
        "project_name": "Diverse",
        "compiler_versions": [
            "0.8.11"
        ]
    },
    "findings": [
        {
            "title": "Highly Permissive Role Access",
            "reported_impact": "Critical",
            "reported_likelihood": "High",
            "cwe_classification": 284,
            "vulnerability_class": "Authorization",
            "vulnerability_subclass": "Excessive Privilege",
            "vulnerable_functions": [
                "XARDMStaking.sol::resetRewards()"
            ],
            "lines": "122-134",
            "description": "The owner of the XARDMS Taking contract can withdraw ARDM tokens deposited by users using the resetRewards() function. When the total ARDM balance in the XARDMS take contract is greater than the total supply of xARDM, the owner can withdraw this difference as ARDM tokens. Although this difference occurs due to an external ARDM transfer to the contract in the form of rewards, share calculations for deposits made after the transfer will be calculated according to the new rate. This leads to a situation where any user who deposits ARDM tokens after the rewards transfer may suffer losses after the owner requests a rewards reset.",
            "possible_found_in": [
                {
                    "element": {
                        "type": "function",
                        "name": "resetRewards",
                        "source_mapping": {
                            "start": 3889,
                            "length": 441,
                            "filename_relative": "contracts/XARDMStaking.sol",
                            "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                            "filename_short": "contracts/XARDMStaking.sol",
                            "is_dependency": false,
                            "lines": "122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134",
                            "starting_column": 5,
                            "ending_column": 6
                        },
                        "type_specific_fields": {
                            "parent": {
                                "type": "contract",
                                "name": "XARDMStaking",
                                "source_mapping": {
                                    "start": 312,
                                    "length": 6848,
                                    "filename_relative": "contracts/XARDMStaking.sol",
                                    "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                                    "filename_short": "contracts/XARDMStaking.sol",
                                    "is_dependency": false,
                                    "lines": "11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226",
                                    "starting_column": 1,
                                    "ending_column": 2
                                }
                            },
                            "signature": "resetRewards(address)"
                        }
                    },
                    "detector": {
                        "description": "XARDMStaking.resetRewards(address) (contracts/XARDMStaking.sol#122-134) ignores return value by ARDM.transfer(to,amount) (contracts/XARDMStaking.sol#133)\n",
                        "markdown": "[XARDMStaking.resetRewards(address)](contracts/XARDMStaking.sol#L122-L134) ignores return value by [ARDM.transfer(to,amount)](contracts/XARDMStaking.sol#L133)\n",
                        "first_markdown_element": "contracts/XARDMStaking.sol#L122-L134",
                        "id": "f70ea7a427541de6ae4b1960e0e524a37a3ba392a516b078cfbe9c559e0c0c12",
                        "check": "unchecked-transfer",
                        "impact": "High",
                        "confidence": "Medium"
                    }
                }
            ]
        },
        {
            "title": "Front-Running Attack; Inflation Attack",
            "reported_impact": "Critical",
            "reported_likelihood": "High",
            "cwe_classification": 190,
            "vulnerability_class": "Arithmetic",
            "vulnerability_subclass": "alculation Flaw",
            "vulnerable_functions": [
                "XARDMStaking.sol::deposit()"
            ],
            "lines": "76-94",
            "description": "The vulnerability is related to a rounding issue in the deposit() function, as illustrated by the following equation: uint256 mintAmount = (_amount â€¢ totalxARDM) / totalARDM; An attacker can manipulate the denominator and cause the victim to receive zero or a portion of the vault.",
            "possible_found_in": [
                {
                    "element": {
                        "type": "function",
                        "name": "deposit",
                        "source_mapping": {
                            "start": 2089,
                            "length": 772,
                            "filename_relative": "contracts/XARDMStaking.sol",
                            "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                            "filename_short": "contracts/XARDMStaking.sol",
                            "is_dependency": false,
                            "lines": "76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94",
                            "starting_column": 5,
                            "ending_column": 6
                        },
                        "type_specific_fields": {
                            "parent": {
                                "type": "contract",
                                "name": "XARDMStaking",
                                "source_mapping": {
                                    "start": 312,
                                    "length": 6848,
                                    "filename_relative": "contracts/XARDMStaking.sol",
                                    "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                                    "filename_short": "contracts/XARDMStaking.sol",
                                    "is_dependency": false,
                                    "lines": "11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226",
                                    "starting_column": 1,
                                    "ending_column": 2
                                }
                            },
                            "signature": "deposit(uint256)"
                        }
                    },
                    "detector": {
                        "description": "XARDMStaking.deposit(uint256) (contracts/XARDMStaking.sol#76-94) ignores return value by ARDM.transferFrom(msg.sender,address(this),_amount) (contracts/XARDMStaking.sol#89)\n",
                        "markdown": "[XARDMStaking.deposit(uint256)](contracts/XARDMStaking.sol#L76-L94) ignores return value by [ARDM.transferFrom(msg.sender,address(this),_amount)](contracts/XARDMStaking.sol#L89)\n",
                        "first_markdown_element": "contracts/XARDMStaking.sol#L76-L94",
                        "id": "b4241d692b3fb89b2b02ac5c94fdb6b051130f3d33cd3d8b8da4a66744f72fcb",
                        "check": "unchecked-transfer",
                        "impact": "High",
                        "confidence": "Medium"
                    }
                },
                {
                    "element": {
                        "type": "function",
                        "name": "deposit",
                        "source_mapping": {
                            "start": 2089,
                            "length": 772,
                            "filename_relative": "contracts/XARDMStaking.sol",
                            "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                            "filename_short": "contracts/XARDMStaking.sol",
                            "is_dependency": false,
                            "lines": "76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94",
                            "starting_column": 5,
                            "ending_column": 6
                        },
                        "type_specific_fields": {
                            "parent": {
                                "type": "contract",
                                "name": "XARDMStaking",
                                "source_mapping": {
                                    "start": 312,
                                    "length": 6848,
                                    "filename_relative": "contracts/XARDMStaking.sol",
                                    "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                                    "filename_short": "contracts/XARDMStaking.sol",
                                    "is_dependency": false,
                                    "lines": "11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226",
                                    "starting_column": 1,
                                    "ending_column": 2
                                }
                            },
                            "signature": "deposit(uint256)"
                        }
                    },
                    "detector": {
                        "description": "XARDMStaking.deposit(uint256) (contracts/XARDMStaking.sol#76-94) uses a dangerous strict equality:\n\t- totalxARDM == 0 || totalARDM == 0 (contracts/XARDMStaking.sol#81)\n",
                        "markdown": "[XARDMStaking.deposit(uint256)](contracts/XARDMStaking.sol#L76-L94) uses a dangerous strict equality:\n\t- [totalxARDM == 0 || totalARDM == 0](contracts/XARDMStaking.sol#L81)\n",
                        "first_markdown_element": "contracts/XARDMStaking.sol#L76-L94",
                        "id": "5df4ff90fa6fa38096ba1043e3a652f6522eb1f2b0967459b0b472cc242b352e",
                        "check": "incorrect-equality",
                        "impact": "Medium",
                        "confidence": "High"
                    }
                },
                {
                    "element": {
                        "type": "function",
                        "name": "deposit",
                        "source_mapping": {
                            "start": 2089,
                            "length": 772,
                            "filename_relative": "contracts/XARDMStaking.sol",
                            "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                            "filename_short": "contracts/XARDMStaking.sol",
                            "is_dependency": false,
                            "lines": "76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94",
                            "starting_column": 5,
                            "ending_column": 6
                        },
                        "type_specific_fields": {
                            "parent": {
                                "type": "contract",
                                "name": "XARDMStaking",
                                "source_mapping": {
                                    "start": 312,
                                    "length": 6848,
                                    "filename_relative": "contracts/XARDMStaking.sol",
                                    "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                                    "filename_short": "contracts/XARDMStaking.sol",
                                    "is_dependency": false,
                                    "lines": "11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226",
                                    "starting_column": 1,
                                    "ending_column": 2
                                }
                            },
                            "signature": "deposit(uint256)"
                        }
                    },
                    "detector": {
                        "description": "Reentrancy in XARDMStaking.deposit(uint256) (contracts/XARDMStaking.sol#76-94):\n\tExternal calls:\n\t- xARDM.mint(msg.sender,_amount) (contracts/XARDMStaking.sol#82)\n\t- xARDM.mint(msg.sender,mintAmount) (contracts/XARDMStaking.sol#86)\n\t- ARDM.transferFrom(msg.sender,address(this),_amount) (contracts/XARDMStaking.sol#89)\n\tState variables written after the call(s):\n\t- _userDeadline[msg.sender] = block.timestamp (contracts/XARDMStaking.sol#92)\n",
                        "markdown": "Reentrancy in [XARDMStaking.deposit(uint256)](contracts/XARDMStaking.sol#L76-L94):\n\tExternal calls:\n\t- [xARDM.mint(msg.sender,_amount)](contracts/XARDMStaking.sol#L82)\n\t- [xARDM.mint(msg.sender,mintAmount)](contracts/XARDMStaking.sol#L86)\n\t- [ARDM.transferFrom(msg.sender,address(this),_amount)](contracts/XARDMStaking.sol#L89)\n\tState variables written after the call(s):\n\t- [_userDeadline[msg.sender] = block.timestamp](contracts/XARDMStaking.sol#L92)\n",
                        "first_markdown_element": "contracts/XARDMStaking.sol#L76-L94",
                        "id": "1c1184b163bd094178ab6cad830bfb00fc27f523cc147ce87530636af0023ea3",
                        "check": "reentrancy-benign",
                        "impact": "Low",
                        "confidence": "Medium"
                    }
                },
                {
                    "element": {
                        "type": "function",
                        "name": "deposit",
                        "source_mapping": {
                            "start": 2089,
                            "length": 772,
                            "filename_relative": "contracts/XARDMStaking.sol",
                            "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                            "filename_short": "contracts/XARDMStaking.sol",
                            "is_dependency": false,
                            "lines": "76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94",
                            "starting_column": 5,
                            "ending_column": 6
                        },
                        "type_specific_fields": {
                            "parent": {
                                "type": "contract",
                                "name": "XARDMStaking",
                                "source_mapping": {
                                    "start": 312,
                                    "length": 6848,
                                    "filename_relative": "contracts/XARDMStaking.sol",
                                    "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                                    "filename_short": "contracts/XARDMStaking.sol",
                                    "is_dependency": false,
                                    "lines": "11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226",
                                    "starting_column": 1,
                                    "ending_column": 2
                                }
                            },
                            "signature": "deposit(uint256)"
                        }
                    },
                    "detector": {
                        "description": "XARDMStaking.deposit(uint256) (contracts/XARDMStaking.sol#76-94) compares to a boolean constant:\n\t-penaltyFeePaused == false (contracts/XARDMStaking.sol#91)\n",
                        "markdown": "[XARDMStaking.deposit(uint256)](contracts/XARDMStaking.sol#L76-L94) compares to a boolean constant:\n\t-[penaltyFeePaused == false](contracts/XARDMStaking.sol#L91)\n",
                        "first_markdown_element": "contracts/XARDMStaking.sol#L76-L94",
                        "id": "aa98844b0a0a141bdf821f93cb9160cb74377fd85e5cacf6cb5c46e9ebb2734c",
                        "check": "boolean-equal",
                        "impact": "Informational",
                        "confidence": "High"
                    }
                },
                {
                    "element": {
                        "type": "variable",
                        "name": "_amount",
                        "source_mapping": {
                            "start": 2106,
                            "length": 15,
                            "filename_relative": "contracts/XARDMStaking.sol",
                            "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                            "filename_short": "contracts/XARDMStaking.sol",
                            "is_dependency": false,
                            "lines": "76",
                            "starting_column": 22,
                            "ending_column": 37
                        },
                        "type_specific_fields": {
                            "parent": {
                                "type": "function",
                                "name": "deposit",
                                "source_mapping": {
                                    "start": 2089,
                                    "length": 772,
                                    "filename_relative": "contracts/XARDMStaking.sol",
                                    "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                                    "filename_short": "contracts/XARDMStaking.sol",
                                    "is_dependency": false,
                                    "lines": "76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94",
                                    "starting_column": 5,
                                    "ending_column": 6
                                },
                                "type_specific_fields": {
                                    "parent": {
                                        "type": "contract",
                                        "name": "XARDMStaking",
                                        "source_mapping": {
                                            "start": 312,
                                            "length": 6848,
                                            "filename_relative": "contracts/XARDMStaking.sol",
                                            "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                                            "filename_short": "contracts/XARDMStaking.sol",
                                            "is_dependency": false,
                                            "lines": "11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226",
                                            "starting_column": 1,
                                            "ending_column": 2
                                        }
                                    },
                                    "signature": "deposit(uint256)"
                                }
                            }
                        },
                        "additional_fields": {
                            "target": "parameter",
                            "convention": "mixedCase"
                        }
                    },
                    "detector": {
                        "description": "Parameter XARDMStaking.deposit(uint256)._amount (contracts/XARDMStaking.sol#76) is not in mixedCase\n",
                        "markdown": "Parameter [XARDMStaking.deposit(uint256)._amount](contracts/XARDMStaking.sol#L76) is not in mixedCase\n",
                        "first_markdown_element": "contracts/XARDMStaking.sol#L76",
                        "id": "84c71df97bdd9df5f9c4af87027fdc89a147bde5b248760795a9229466181ab6",
                        "check": "naming-convention",
                        "impact": "Informational",
                        "confidence": "High"
                    }
                }
            ]
        },
        {
            "title": "Undocumented Behavior",
            "reported_impact": "High",
            "reported_likelihood": "High",
            "cwe_classification": 113,
            "vulnerability_class": "Documentation",
            "vulnerability_subclass": "Missing Explanation",
            "vulnerable_functions": [
                "XARDMStaking.sol::onlyEOA()"
            ],
            "lines": "53-57",
            "description": "The system is designed to allow EOA accounts, this may limit functionality"
        },
        {
            "title": "Highly Permissive Role Access",
            "reported_impact": "High",
            "reported_likelihood": "High",
            "cwe_classification": 284,
            "vulnerability_class": "Authorization",
            "vulnerability_subclass": "Excessive Privilege",
            "vulnerable_functions": [
                "XARDMStaking.sol::deposit()"
            ],
            "lines": "76-94",
            "description": "The owner of the XARDMStaking contract can change the penalty deadline and penalty fee values after users have deposited ARDM tokens based on the previous penalty values. Changing the penalty and fine deadline will affect users who have stakes in the system and will make them pay different fines than promised.",
            "possible_found_in": [
                {
                    "element": {
                        "type": "node",
                        "name": "ARDM.transferFrom(msg.sender,address(this),_amount)",
                        "source_mapping": {
                            "start": 2692,
                            "length": 53,
                            "filename_relative": "contracts/XARDMStaking.sol",
                            "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                            "filename_short": "contracts/XARDMStaking.sol",
                            "is_dependency": false,
                            "lines": "89",
                            "starting_column": 9,
                            "ending_column": 62
                        },
                        "type_specific_fields": {
                            "parent": {
                                "type": "function",
                                "name": "deposit",
                                "source_mapping": {
                                    "start": 2089,
                                    "length": 772,
                                    "filename_relative": "contracts/XARDMStaking.sol",
                                    "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                                    "filename_short": "contracts/XARDMStaking.sol",
                                    "is_dependency": false,
                                    "lines": "76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94",
                                    "starting_column": 5,
                                    "ending_column": 6
                                },
                                "type_specific_fields": {
                                    "parent": {
                                        "type": "contract",
                                        "name": "XARDMStaking",
                                        "source_mapping": {
                                            "start": 312,
                                            "length": 6848,
                                            "filename_relative": "contracts/XARDMStaking.sol",
                                            "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                                            "filename_short": "contracts/XARDMStaking.sol",
                                            "is_dependency": false,
                                            "lines": "11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226",
                                            "starting_column": 1,
                                            "ending_column": 2
                                        }
                                    },
                                    "signature": "deposit(uint256)"
                                }
                            }
                        }
                    },
                    "detector": {
                        "description": "XARDMStaking.deposit(uint256) (contracts/XARDMStaking.sol#76-94) ignores return value by ARDM.transferFrom(msg.sender,address(this),_amount) (contracts/XARDMStaking.sol#89)\n",
                        "markdown": "[XARDMStaking.deposit(uint256)](contracts/XARDMStaking.sol#L76-L94) ignores return value by [ARDM.transferFrom(msg.sender,address(this),_amount)](contracts/XARDMStaking.sol#L89)\n",
                        "first_markdown_element": "contracts/XARDMStaking.sol#L76-L94",
                        "id": "b4241d692b3fb89b2b02ac5c94fdb6b051130f3d33cd3d8b8da4a66744f72fcb",
                        "check": "unchecked-transfer",
                        "impact": "High",
                        "confidence": "Medium"
                    }
                },
                {
                    "element": {
                        "type": "node",
                        "name": "totalxARDM == 0 || totalARDM == 0",
                        "source_mapping": {
                            "start": 2343,
                            "length": 33,
                            "filename_relative": "contracts/XARDMStaking.sol",
                            "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                            "filename_short": "contracts/XARDMStaking.sol",
                            "is_dependency": false,
                            "lines": "81",
                            "starting_column": 13,
                            "ending_column": 46
                        },
                        "type_specific_fields": {
                            "parent": {
                                "type": "function",
                                "name": "deposit",
                                "source_mapping": {
                                    "start": 2089,
                                    "length": 772,
                                    "filename_relative": "contracts/XARDMStaking.sol",
                                    "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                                    "filename_short": "contracts/XARDMStaking.sol",
                                    "is_dependency": false,
                                    "lines": "76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94",
                                    "starting_column": 5,
                                    "ending_column": 6
                                },
                                "type_specific_fields": {
                                    "parent": {
                                        "type": "contract",
                                        "name": "XARDMStaking",
                                        "source_mapping": {
                                            "start": 312,
                                            "length": 6848,
                                            "filename_relative": "contracts/XARDMStaking.sol",
                                            "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                                            "filename_short": "contracts/XARDMStaking.sol",
                                            "is_dependency": false,
                                            "lines": "11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226",
                                            "starting_column": 1,
                                            "ending_column": 2
                                        }
                                    },
                                    "signature": "deposit(uint256)"
                                }
                            }
                        }
                    },
                    "detector": {
                        "description": "XARDMStaking.deposit(uint256) (contracts/XARDMStaking.sol#76-94) uses a dangerous strict equality:\n\t- totalxARDM == 0 || totalARDM == 0 (contracts/XARDMStaking.sol#81)\n",
                        "markdown": "[XARDMStaking.deposit(uint256)](contracts/XARDMStaking.sol#L76-L94) uses a dangerous strict equality:\n\t- [totalxARDM == 0 || totalARDM == 0](contracts/XARDMStaking.sol#L81)\n",
                        "first_markdown_element": "contracts/XARDMStaking.sol#L76-L94",
                        "id": "5df4ff90fa6fa38096ba1043e3a652f6522eb1f2b0967459b0b472cc242b352e",
                        "check": "incorrect-equality",
                        "impact": "Medium",
                        "confidence": "High"
                    }
                },
                {
                    "element": {
                        "type": "node",
                        "name": "xARDM.mint(msg.sender,_amount)",
                        "source_mapping": {
                            "start": 2392,
                            "length": 31,
                            "filename_relative": "contracts/XARDMStaking.sol",
                            "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                            "filename_short": "contracts/XARDMStaking.sol",
                            "is_dependency": false,
                            "lines": "82",
                            "starting_column": 13,
                            "ending_column": 44
                        },
                        "type_specific_fields": {
                            "parent": {
                                "type": "function",
                                "name": "deposit",
                                "source_mapping": {
                                    "start": 2089,
                                    "length": 772,
                                    "filename_relative": "contracts/XARDMStaking.sol",
                                    "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                                    "filename_short": "contracts/XARDMStaking.sol",
                                    "is_dependency": false,
                                    "lines": "76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94",
                                    "starting_column": 5,
                                    "ending_column": 6
                                },
                                "type_specific_fields": {
                                    "parent": {
                                        "type": "contract",
                                        "name": "XARDMStaking",
                                        "source_mapping": {
                                            "start": 312,
                                            "length": 6848,
                                            "filename_relative": "contracts/XARDMStaking.sol",
                                            "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                                            "filename_short": "contracts/XARDMStaking.sol",
                                            "is_dependency": false,
                                            "lines": "11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226",
                                            "starting_column": 1,
                                            "ending_column": 2
                                        }
                                    },
                                    "signature": "deposit(uint256)"
                                }
                            }
                        },
                        "additional_fields": {
                            "underlying_type": "external_calls"
                        }
                    },
                    "detector": {
                        "description": "Reentrancy in XARDMStaking.deposit(uint256) (contracts/XARDMStaking.sol#76-94):\n\tExternal calls:\n\t- xARDM.mint(msg.sender,_amount) (contracts/XARDMStaking.sol#82)\n\t- xARDM.mint(msg.sender,mintAmount) (contracts/XARDMStaking.sol#86)\n\t- ARDM.transferFrom(msg.sender,address(this),_amount) (contracts/XARDMStaking.sol#89)\n\tState variables written after the call(s):\n\t- _userDeadline[msg.sender] = block.timestamp (contracts/XARDMStaking.sol#92)\n",
                        "markdown": "Reentrancy in [XARDMStaking.deposit(uint256)](contracts/XARDMStaking.sol#L76-L94):\n\tExternal calls:\n\t- [xARDM.mint(msg.sender,_amount)](contracts/XARDMStaking.sol#L82)\n\t- [xARDM.mint(msg.sender,mintAmount)](contracts/XARDMStaking.sol#L86)\n\t- [ARDM.transferFrom(msg.sender,address(this),_amount)](contracts/XARDMStaking.sol#L89)\n\tState variables written after the call(s):\n\t- [_userDeadline[msg.sender] = block.timestamp](contracts/XARDMStaking.sol#L92)\n",
                        "first_markdown_element": "contracts/XARDMStaking.sol#L76-L94",
                        "id": "1c1184b163bd094178ab6cad830bfb00fc27f523cc147ce87530636af0023ea3",
                        "check": "reentrancy-benign",
                        "impact": "Low",
                        "confidence": "Medium"
                    }
                },
                {
                    "element": {
                        "type": "node",
                        "name": "penaltyFeePaused == false",
                        "source_mapping": {
                            "start": 2760,
                            "length": 25,
                            "filename_relative": "contracts/XARDMStaking.sol",
                            "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                            "filename_short": "contracts/XARDMStaking.sol",
                            "is_dependency": false,
                            "lines": "91",
                            "starting_column": 13,
                            "ending_column": 38
                        },
                        "type_specific_fields": {
                            "parent": {
                                "type": "function",
                                "name": "deposit",
                                "source_mapping": {
                                    "start": 2089,
                                    "length": 772,
                                    "filename_relative": "contracts/XARDMStaking.sol",
                                    "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                                    "filename_short": "contracts/XARDMStaking.sol",
                                    "is_dependency": false,
                                    "lines": "76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94",
                                    "starting_column": 5,
                                    "ending_column": 6
                                },
                                "type_specific_fields": {
                                    "parent": {
                                        "type": "contract",
                                        "name": "XARDMStaking",
                                        "source_mapping": {
                                            "start": 312,
                                            "length": 6848,
                                            "filename_relative": "contracts/XARDMStaking.sol",
                                            "filename_absolute": "/home/tiki/trabajo/goose/Diverse00/vulnerable/ardmoney-sARDM-staking-contract/contracts/XARDMStaking.sol",
                                            "filename_short": "contracts/XARDMStaking.sol",
                                            "is_dependency": false,
                                            "lines": "11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226",
                                            "starting_column": 1,
                                            "ending_column": 2
                                        }
                                    },
                                    "signature": "deposit(uint256)"
                                }
                            }
                        }
                    },
                    "detector": {
                        "description": "XARDMStaking.deposit(uint256) (contracts/XARDMStaking.sol#76-94) compares to a boolean constant:\n\t-penaltyFeePaused == false (contracts/XARDMStaking.sol#91)\n",
                        "markdown": "[XARDMStaking.deposit(uint256)](contracts/XARDMStaking.sol#L76-L94) compares to a boolean constant:\n\t-[penaltyFeePaused == false](contracts/XARDMStaking.sol#L91)\n",
                        "first_markdown_element": "contracts/XARDMStaking.sol#L76-L94",
                        "id": "aa98844b0a0a141bdf821f93cb9160cb74377fd85e5cacf6cb5c46e9ebb2734c",
                        "check": "boolean-equal",
                        "impact": "Informational",
                        "confidence": "High"
                    }
                }
            ]
        },
        {
            "title": "Requirements Violation; Race Condition",
            "reported_impact": "High",
            "reported_likelihood": "High",
            "cwe_classification": 362,
            "vulnerability_class": "Concurrency",
            "vulnerability_subclass": "Logic Flaw",
            "vulnerable_functions": [
                "XARDMStaking.sol::deposit(), withdraw()"
            ],
            "lines": "",
            "description": "User deadlines are not modified when they make a deposit, as long as the deadline to pay the penalty has not yet arrived, and new deposits made are recorded to be processed with the same deadline. Users can wait until the last stage of the deadline by depositing a very small amount of tokens and then deposit the desired amount at the last minute to collect their rewards a few minutes later."
        },
        {
            "title": "Unchecked Transfer",
            "reported_impact": "Medium",
            "reported_likelihood": "High",
            "cwe_classification": 477,
            "vulnerability_class": "Validation",
            "vulnerability_subclass": "Missing Validation",
            "vulnerable_functions": [
                "XARDMStaking.sol::deposit(), withdraw(),resetRewards()"
            ],
            "lines": "",
            "description": "They do not use the SafeERC20 library to verify the result of ERC20 token transfers. The tokens may not follow the ERC20 standard and return a false value in case of transfer failure or return no value at all."
        },
        {
            "title": "Highly Permissive Role Access",
            "reported_impact": "Medium",
            "reported_likelihood": "High",
            "cwe_classification": 284,
            "vulnerability_class": "Authorization",
            "vulnerability_subclass": "Excessive Privilege",
            "vulnerable_functions": [
                "XARDMStaking.sol::pause(), unpause()"
            ],
            "lines": "",
            "description": "Highly Permissive Role Access Account with PAUSER_ROLE can pause the transferability of the XARDM token. This leads to a situation where the deposit() and withdrawal() functions of the XARDMStaking contract are affected by a denial of service vulnerability. As both systems are closely connected and there is functionality to pause deposits and withdrawals directly in XARDMStaking, the pausable nature of the XARDM token seems redundant."
        }
    ]
}